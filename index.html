<!DOCTYPE html>
<!--
Openlayers 기본지도 생성, WMTS API
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>브이월드 WMTS 배경지도 사용하기 오픈레이어스 3버전 이상</title>
    <script src="ol/ol.js"></script>
    <link rel="stylesheet" 	href="ol/ol.css" type="text/css">
    <!--제이쿼리 사용을 위한 CDN-->
    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
</head>

<body>
<!--map을 띄울 div박스. 여기서는 style을 태그에 바로 적용시켰다.-->
<div id="map" style="width: 100%; height: 400px; left: 0px; top: 0px"></div>
<!--토글 버튼을 만들어 보자-->
<div>
    <button onclick="AddSatellite()">위성사진</button>
</div>

<script type="text/javascript">

    let checkSatellite = false;

    let Base = new ol.layer.Tile({
        name : "Base",
        source: new ol.source.XYZ({
            url: 'http://api.vworld.kr/req/wmts/1.0.0/CEB52025-E065-364C-9DBA-44880E3B02B8/Base/{z}/{y}/{x}.png'  // WMTS API 사용
        })
    });

    let Satellite = new ol.layer.Tile({
        name : "Satellite",
        source: new ol.source.XYZ({
            url: 'http://api.vworld.kr/req/wmts/1.0.0/CEB52025-E065-364C-9DBA-44880E3B02B8/Satellite/{z}/{y}/{x}.jpeg'  // WMTS API 사용
            /*자료 확인하면, Satellite는 .png가 아니라 .jpeg다.*/
        })
    });

    let OSM = new ol.layer.Tile({
        name : "Base",
        source: new ol.source.OSM()
    });

    // var debug = new ol.layer.Tile({
    // 	name : "debug",
    // 	source: new ol.source.TileDebug() //ol 6버전에 생김
    // }); // 타일의 넘버링을 확인할 수 있음 z: 레벨  / y 위 아래 , x 좌 우    /{z}7/{y}47/{x}111.png


    /* 이렇게 변수로 지정하여도 괜찮으나, 나는 view에 바로 생성자 만들어주는 것이 더 가독성이 있다.
        let olView = new ol.View({
            center: ol.proj.transform([129.1705,35.1614], 'EPSG:4326', 'EPSG:3857'),/!*좌표계 변환
                                                                                        위도 경도를 부산 해운대로 설정해뒀다.*!/
            zoom: 10

        })// 뷰 설정
    */
    let map = new ol.Map({
//        layers: [OSM,Base], //[OSM,Base,debug]
        layers: [Base], // <---Base가 VWorld의 베이스임. []빼도 될 것이라 생각했으나, 빼면 오류 뜬다.
        target: 'map',
        view: new ol.View({
            center: ol.proj.transform([129.1705,35.1614], 'EPSG:4326', 'EPSG:3857'),/*좌표계 변환
                                                                                    위도 경도를 부산 해운대로 설정해뒀다.*/
            zoom: 10

        })// 뷰 설정
    });//


    function AddSatellite(){    //위성사진 버튼을 클릭하면 layer 추가
        if(checkSatellite){
            map.removeLayer(Satellite);  //removeLayer 메소드 이용하기 좋다.
            // map.addLayer(Base);
            console.log(checkSatellite);
            checkSatellite = false;
        } else{
        map.addLayer(Satellite);    //addLayer 메소드 이용하기 좋다.
        checkSatellite = true;
        }
    }
</script>
</body>
</html>